\section{Lecture -- Week 9}

\subsection{Norm and trace}

\begin{definition}
\index{Trace}
\index{Norm}
    Let $E/K$ be a finite extension and $C/K$ be an algebraic closure 
    that contains $E$. Let $A=\Hom(E/K,C/K)$. For $x\in E$
    we define the \emph{trace} of $x$ in $E/K$ 
    as 
    \[
    \trace_{E/K}(x)=[E:K]_{\operatorname{ins}}\sum_{\varphi\in A}\varphi(x)
    \]
    and the \emph{norm} of $x$ in $E/K$ as
    \[
    \norm_{E/K}(x)=\left(\prod_{\varphi\in A}\varphi(x)\right)^{[E:K]_{\operatorname{ins}}}.
    \]
\end{definition}

As an optional exercise, one can show that these definitions do not depend on the algebraic closure. 

We collect some basic properties as an exercise:

\begin{exercise}
\label{xca:norm_and_trace}
    Let $E/K$ be a finite extension. The following statements hold:
    \begin{enumerate}
        \item If $E/K$ is not separable, then $\trace_{E/K}(x)=0$ for all $x\in E$.
        \item If $x\in K$, then $\trace_{E/K}(x)=[E:K]x$.
        \item $\trace_{E/K}(x)\in K$ for all $x\in E$.
        \item $\norm_{E/K}(x)=0$ if and only if $x=0$. 
        \item If $x\in K$, then $\norm_{E/K}(x)=x^{[E:K]}$. 
        \item $\norm_{E/K}(x)\in K$ for all $x\in E$. 
    \end{enumerate}
\end{exercise}

One proves, moreover, that  
$\trace_{E/K}\colon E\to K$ 
satisfies
\[
\trace_{E/K}(x+\lambda y)=
\trace_{E/K}(x)+\lambda\trace_{E/K}(y)
\]
for all $x,y\in E$ and $\lambda\in K$, that is to say that 
$\trace_{E/K}\colon E\to K$ 
is a 
linear form in $E$ The norm  
$\norm_{E/K}\colon E^{\times}\to K^{\times}$ 
is a group homomorphism. 

\begin{exercise}
        Let $E/K$ be a finite extension and
        $x\in E$ be algebraic. If
        \[
        f(x,K)=X^n+a_{n-1}X^{n-1}+\cdots+a_1X+a_0,
        \]
        then 
        $\norm_{E/K}(x)=\left((-1)^na_0\right)^{[E:K(x)]}$ and 
        $\trace_{E/K}(x)=-[E:K(x)]a_{n-1}$. 
\end{exercise}

\begin{example}
    Let $E=\Q(\sqrt{2},\sqrt{3})$. Then 
    \begin{align*}
    &\trace_{E/\Q}(\sqrt{2})=0,
    &&
    \norm_{E/\Q}(\sqrt{2})=4,\\
    &\trace_{E/\Q(\sqrt{2})}(\sqrt{2})=2\sqrt{2},
    &&\norm_{E/\Q(\sqrt{2})}(\sqrt{2})=2.    
    \end{align*}
\end{example}

\begin{example}
    If $E/K$ is a finite Galois extension, then 
    \[
    \trace_{E/K}(x)=\sum_{\sigma\in\Gal(E/K)}\sigma(x)
    \quad\text{and}\quad
    \norm_{E/K}(x)=\prod_{\sigma\in\Gal(E/K)}\sigma(x)
    \]
    for all $x\in E$. In particular, since $E=K(y)$ for some
    $y$ by Proposition \ref{pro:monogenic}, 
    \[
    \trace_{E/K}(y)=-a_{n-1}
    \quad\text{and}\quad
    \norm_{E/K}(y)=(-1)^na_0,
    \]
    where
    $f(y,K)=X^n+a_{n-1}X^{n-1}+\cdots+a_1X+a_0$.
\end{example}        

\subsection{Finite fields}

In this section, $p$ will be a prime number. 

\begin{proposition}
    Let $m$ be a positive integer. 
    Up to isomorphism, there exists a unique 
    field $F_{p^m}$ of size $p^m$. 
\end{proposition}

\begin{proof}
    Let $C$ be an algebraic closure of the field $\Z/p$ and 
    let $F_{p^m}=\{x\in C:x^{p^m}=x\}$ be the set of roots of $X^{p^m}-X$. Since 
    the polynomial $X^{p^m}-X$ has no multiple roots, $|F_{p^m}|=p^m$. Moreover, 
    $F_{p^m}$ is the unique subfield of $C$ of size $p^m$. 
    
    To prove the uniqueness, it is enough to note that 
    if $K$ is a field of $p^m$ elements, then
    $K$ is the splitting field of $X^{p^m}-X$ over $\Z/p$.  
\end{proof}

Let $K=\Z/p$ and $C$ be an algebraic closure of $K$. 
We claim that $C=\bigcup_k F_{p^k}$. If $x\in C$, then $x$ is algebraic over $K$. 
Since $K(x)/K$ is finite, $K(x)$ is a finite field, say 
$|K|=p^r$ for some $r$. Then $x^{p^r}=x$ and hence $x\in F_{p^r}$. 

\begin{exercise}
    Prove the following statements:
    \begin{enumerate}
        \item If $x\in F_{p^r}$, then $x^{p^{rk}}=x$ for all $k\geq0$.
        %\item If $m\mid n$, then $F_{p^m}\subseteq F_{p^n}$. 
        \item $F_{p^m}\subseteq F_{p^n}$ if and only if $m\mid n$. 
        \item $F_{p^m}\cap F_{p^n}=F_{p^{\gcd(m,n)}}$.
    \end{enumerate}
\end{exercise}

\begin{proposition}
    Every finite extension of a finite field is cyclic. 
\end{proposition}

\begin{proof}
    Let $K=\Z/p$. It is enough to show that $F_{p^n}/F_{p^m}$ is cyclic if $m$ divides $n$. 
    
    We first prove that $F_{p^n}/K$ is cyclic. 
    Let 
    \[
    \sigma\colon F_{p^n}\to F_{p^n},\quad 
    x\mapsto x^p.
    \]
    Then 
    $\sigma\in\Gal(F_{p^n}/K)$ (it is bijective because all field homomorphisms 
    are injective and $F_{p^n}$ is finite). 

    Note that 
    $F_{p^n}/K$ is a Galois extension, as $F_{p^n}$ is the splitting
    field over $K$ 
    of the separable polynomial $X^{p^n}-X\in K[X]$. 
    Thus $|\Gal(F_{p^n}/K)|=[F_{p^n}:K]=n$. 
    
    We claim that $\sigma$ generated $\Gal(F_{p^n}/K)$. Since 
    $\sigma^i(x)=x^{p^i}$ for all $i\geq 0$, in particular, 
    \[
    \sigma^n(x)=x^{p^n}=x.
    \]
    Thus $\sigma^n=\id$ and hence $|\sigma|$ divides $n$. Let 
    $s=|\sigma|$. We know that $F_{p^n}^{\times}=F_{p^n}\setminus\{0\}$ is
    cyclic, say $F_{p^n}^{\times}=\langle g\rangle$. Since $|g|=p^n-1$, 
    \[
    g=\sigma^s(g)=g^{p^s}
    \]
    and hence $p^s\equiv 1\bmod (p^n-1)$. Thus $p^n-1$ divides $p^s-1$ and
    hence $n$ divides $s$. Therefore $n=s$ and $\Gal(F_{p^n}/K)=\langle\sigma\rangle$. 
    
    For the general case, note that if $m$ divides $n$, 
    then the Galois group 
    $\Gal(F_{p^n}/F_{p^m})$ is a subgroup of $\Gal(F_{p^n}/K)$. Since  $\Gal(F_{p^n}/K)$ is cyclic, 
    the claim follows.
\end{proof}

\index{Frobenius automorphism}
If $K=\Z/p$ and 
$m$ divides $n$, the subextension $F_{p^m}$ corresponds 
to the unique
subgroup of index $m$ of $\Gal(F_{p^n}/K)=\langle\sigma\rangle$. This subgroup
is $\langle\sigma^m\rangle$, where
\[
\sigma^m(x)=x^{p^m}=x^{|F_{p^m}|}.
\]
Note that $\Gal(F_{p^n}/F_{p^m})=\langle\sigma^m\rangle$. 
The map $\sigma^m$ is known as 
the \emph{Frobenius automorphism}. 

\begin{exercise}
    Let $E/K$ be an extension of finite fields. Then $E/K$ 
    is cyclic. Moreover, $\Gal(E/K)=\langle\tau\rangle$, where $\tau(x)=x^{|K|}$. 
\end{exercise}

% page 96
% number of irreducible polynomials
% Moebius inversion formula in commutative rings



\subsection{Cyclotomic extensions}

For $n\geq1$ let $G_n(K)=\{x\in K:x^n=1\}$ be the 
set of $n$-roots of one in $K$. Note that
$G_n(K)$ is a cyclic subgroup of $K^{\times}$ and that 
$|G_n(K)|$ divides $n$. 

\begin{example}
    $G_n(\R)=\{-1,1\}$ if $n$ is odd and $G_{n}(\R)=\{1\}$ if $n$ is even.
\end{example}

\begin{exercise}
    Let $K$ be a field of characteristic $p>0$. Let $n=p^sm$ for some $m$ not divisible by $p$. 
    Then $G_n(K)=G_m(K)$. 
\end{exercise}

\begin{exercise}
    Let $q$ be a prime number. Then $G_n(\Z/q)\simeq\Z/\gcd(n,q-1)$. 
\end{exercise}

Similarly, one can prove that if $K$ is a finite field, then $G_n(K)$ is a cyclic group
of order $\gcd(n,|K^{\times}|)$. 

\begin{example}
    If $C$ is algebraically closed of characteristic coprime with $n$, 
    then $G_n(C)$ is cyclic of order $n$, as $X^n-1$ 
    has all its roots in $C$ and does not contain multiple roots. 
\end{example}

Let $K$ be an algebraically closed field and $n$ be
such that $n$ is coprime with the characteristic of $K$. The set of 
\emph{primitive $n$-roots} is defined as 
\[
H_n(K)=\{x\in G_n(K):|x|=n\}.
\]

\begin{definition}
\index{Cyclotomic polynomial}
    Let $K$ be an algebraically closed field and $n$ be
    such that $n$ is coprime with the characteristic of $K$. The \emph{$n$-th cyclotomic
    polynomial} is defined as 
    \[
    \Phi_n=\prod_{x\in H_n(K)}(X-x)\in K[X].
    \]
\end{definition}

\index{Euler's $\phi$ function}
For $n\geq1$ the Euler's function is defined as 
\[
\varphi(n)=|\{k:1\leq k\leq n,\;\gcd(k,n)=1\}|.
\]
For example, $\varphi(4)=2$, $\varphi(8)=\varphi(10)=4$ and $\varphi(p)=p-1$ for every prime $p$. 

\begin{proposition}
    Let $K$ be an algebraically closed field and $n$ be
    such that $n$ is coprime with the characteristic of $K$. Let $A$ be
    the prime subring of $K$. 
    \begin{enumerate}
        \item $\deg\Phi_n=\varphi(n)$.
        \item $\Phi_n\in A[X]$.
    \end{enumerate}
\end{proposition}

\begin{proof}
    The first statement is clear. Let us prove 2) by induction on $n$. The case $n=1$ is
    trivial, as $\Phi_1=X-1$. Assume that $\Phi_d\in A[X]$ for all $d$ such that $d<n$. 
    In particular,
    \[
    \gamma=\prod_{\substack{d\mid n\\d\ne n}}\Phi_d\in A[X].
    \]
    Since $\gamma$ is monic, it follows that 
    $\frac{X^n-1}{\gamma}\in A[X]$. Now the claim follows from 
    \[
    X^n-1=\prod_{d\mid n}\Phi_d=\Phi_n\prod_{\substack{d\mid n\\d\ne n}}\Phi_d=\Phi_n\gamma.\qedhere
    \]
\end{proof}

By taking degree in the equality 
$X^n-1=\prod_{d\mid n}\Phi_d$ 
one gets 
\[
n=\sum_{d\mid n}\varphi(d).
\]

\begin{definition}
\label{defn:cyclotomic}
\index{Extension!cyclotomic}
    Let $n\geq2$ and $K$ be a field of characteristic coprime with $n$. A 
    \emph{cyclotomic extension} of $K$ of index $n$ is a 
    splitting field of $X^n-1$ over $K$. 
\end{definition}

Let $C$ be an algebraic closure of $K$ and $n\geq2$ be coprime with the characteristic of $K$. 
If follows from Definition \ref{defn:cyclotomic} 
that a cyclotomic extension of index $n$ is of the form 
$K(\omega)/K$ for some $\omega\in H_n(K)$. 

\begin{proposition}
    A cyclotomic extension of index $n$ is abelian and of degree a divisor of $\varphi(n)$. 
\end{proposition}

\begin{proof}
    Let $C$ be an algebraic closure of $K$ and $n\geq2$ be coprime with the characteristic of $K$. 
    Let $\omega\in H_n(C)$ and $K(\omega)/K$ be a cyclotomic extension. Then $K(\omega)/K$
    is a Galois extension, as it is a splitting field of a separable polynomial. 
    Let $U=\mathcal{U}(\Z/n)$ be the group of units of $\Z/n$ and 
    \[
    \lambda\colon \Gal(K(\omega)/K)\to U,
    \quad
    \sigma\mapsto m_{\sigma},
    \]
    where $m_{\sigma}$ is such that $\sigma(\omega)=\omega^{m_{\sigma}}$. The map $\lambda$ is well-defined and
    it is a group homomorphism, as if $\sigma,\tau\in\Gal(K(\omega)/K)$, then, since 
    \[
        (\tau\sigma)(\omega)=\tau(\sigma(\omega))=\tau(\omega^{m_\sigma})=\left(\omega^{m_\sigma}\right)^{m_\tau}=\omega^{m_\sigma m_\tau},
    \]
    it follows that $\lambda(\sigma)\lambda(\tau)=\lambda(\sigma\tau)$. Since 
    $\lambda$ is injective, $\Gal(K(\omega)/K)$ is isomorphic to a subgroup 
    of the abelian group $U$. Hence $\Gal(K(\omega)/K)$ is abelian. Moreover, 
    \[
    [K(\omega):K]=|\Gal(K(\omega)/K)|
    \]
    is a divisor of $|U|=\varphi(n)$. 
\end{proof}

\begin{exercise}
    Prove that a cyclotomic extension $K(\omega)/K$ has degree $\varphi(n)$ if and only if 
    $\Phi_n$ is irreducible over $K$. 
\end{exercise}

Note that $\Phi_n$ is irreducible over $\Q$. Some concrete examples:
\[
\Phi_1=X-1,
\quad
\Phi_2=X+1,
\quad
\Phi_3=X^2+X+1,
\quad
\Phi_6=X^2-X+1.
\]
If $p$ is a prime number, then $\Phi_p=X^{p-1}+\cdots+X+1$. 

\begin{example}
    $\Phi_5$ is irreducible over $\Z/2$. First note that
    $\Phi_5=X^{4}+\cdots+X+1$ does not have roots in $\Z/2$. If 
    $\Phi_5$ is reducible, then, since
    $X^2+X+1$ is the unique degree-two 
    monic irreducible polynomial 
    over $\Z/2$, it follows that
    \[
    \Phi_5=(X^2+X+1)(X^2+X+1)=(X^2+X+1)^2=X^4+X^2+1,
    \]
    a contradiction.
\end{example}

\begin{exercise}
Prove that
$\Phi_{12}=X^4-X^2+1$ is not irreducible over $\Z/5$. 
\end{exercise}

\subsection{Hilbert's theorem 90}

\begin{theorem}[Hilbert]
    Let $E/K$ be a cyclic extension. Assume that 
    $\Gal(E/K)$ is generated by $\tau$. For 
    $a\in E$, $\norm_{E/K}(a)=1$ if and only 
    if $a=b/\tau(b)$ for some $b\in E\setminus\{0\}$. 
\end{theorem}

\begin{proof}
    Let $n=|G|$. We first prove $\impliedby$. If $a=b/\tau(b)$ and $b\ne 0$, then 
    \[
    \norm_{E/K}(a)=a\tau(a)\tau^2(a)\cdots\tau^{n-1}(a)
    =\frac{b}{\tau(b)}\frac{\tau(b)}{\tau^2(b)}\cdots\frac{\tau^{n-1}(b)}{\tau^n(b)}=1.
    \]

    Now we prove $\implies$. Let $a\in E$ be such that $\norm_{E/K}(a)=1$. For 
    $c\in E$ let 
    \begin{align*}
        d_0 &= ac,\\
        d_1 &= a\tau(a)\tau(c),\\
        d_2 &= a\tau(a)\tau^2(a)\tau^2(c),\\
        &\vdots\\
        d_{n-1} &= \underbrace{a\tau(a)\cdots\tau^{n-1}(a)}_{=\norm_{E/K}(a)}\tau^{n-1}(c)=\tau^{n-1}(c).
    \end{align*}
    Then 
    \[
    a\tau(d_j)=a\tau(a)\cdots\tau^{j+1}(a)\tau^{j+1}(c)=d_{j+1}
    \]
    for all $j\in\{0,\dots,n-2\}$. Let $b=d_0+\cdots+d_{n-1}$. We claim that 
    $b\ne 0$ for some $c$. Suppose this is not true, say $b=0$ for all $c$. Then 
    \begin{align*}
    0&=ac+(a\tau(a))\tau(c)+\cdots+(a\tau(a)\cdots\tau^{n-1}(a))\tau^{n-1}(c)
    \end{align*}
    for every $c\in E$. This 
    implies that $a=0$ by Dedekind's theorem, a contradiction. 
    
    So let $c\in E$ be
    such that $b\ne 0$. Then 
    \begin{align*}
    \tau(b)&=\tau(d_0)+\cdots+\tau(d_{n-1})\\
    &=\tau(ac)+\tau(a\tau(c))+\cdots+\tau(\tau^{n-1}(c))\\
    &=\frac{1}{a}(d_1+\cdots+d_{n-1})+\tau^n(c)\\
    &=\frac{1}{a}(d_0+\cdots+d_{n-1})\\
    &=b/a.\qedhere
    \end{align*}
\end{proof}

\begin{exercise}
    Let $E/K$ be a cyclic extension. Assume that 
    $\Gal(E/K)$ is generated by $\tau$. Prove that for 
    $a\in E$, $\trace_{E/K}(a)=0$ if an only 
    if $a=b-\tau(b)$ for some $b\in L\setminus\{0\}$.  
\end{exercise}
